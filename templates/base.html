<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <meta name="theme-color" content="#2563eb" />
    <meta
      name="description"
      content="RecuerdaMe - Acompañamiento digital para personas con Alzheimer"
    />

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json" />
    <link
      rel="icon"
      type="image/png"
      href="{{ url_for('static', filename='img/icon.png') }}"
    />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="RecuerdaMe" />

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />

    <!-- Custom Styles -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />

    <title>{% block title %}RecuerdaMe{% endblock %}</title>
  </head>
  <body class="bg-light" data-bs-theme="light">
    <!-- Navbar -->
    <nav
      class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top"
    >
      <div class="container-fluid">
        <!-- Brand -->
        <a
          class="navbar-brand fw-bold text-primary"
          href="{{ url_for('dashboard') }}"
        >
          <i class="bi bi-heart-fill me-2"></i>
          RecuerdaMe
        </a>

        <!-- Right side controls -->
        <div class="d-flex align-items-center gap-2 ms-auto">
          <!-- Accessibility Controls -->
          <button
            class="btn btn-outline-secondary btn-sm"
            id="toggleContrast"
            title="Alternar alto contraste"
            aria-label="Alternar alto contraste"
          >
            <i class="bi bi-circle-half"></i>
          </button>

          <!-- Menu Toggle (Offcanvas trigger) -->
          <button
            class="navbar-toggler border-0"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#mainMenu"
            aria-controls="mainMenu"
            aria-label="Abrir menú"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="{% block main_class %}container-fluid p-0{% endblock %}">
      {% block content %}{% endblock %}
    </main>

    <!-- Offcanvas Menu -->
    <div
      class="offcanvas offcanvas-start"
      tabindex="-1"
      id="mainMenu"
      aria-labelledby="mainMenuLabel"
    >
      <div class="offcanvas-header bg-primary text-white">
        <h5 class="offcanvas-title" id="mainMenuLabel">
          <i class="bi bi-list me-2"></i>
          Menú Principal
        </h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="offcanvas"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="offcanvas-body p-0">
        <nav class="nav flex-column">
          <a
            class="nav-link d-flex align-items-center py-3 px-4 {% if request.endpoint == 'dashboard' %}active bg-primary-subtle{% endif %}"
            href="{{ url_for('dashboard') }}"
          >
            <i class="bi bi-geo-alt-fill me-3 fs-5"></i>
            <span class="fs-6">Mapa de Ubicación</span>
          </a>

          <a
            class="nav-link d-flex align-items-center py-3 px-4 {% if request.endpoint == 'memories_list' %}active bg-primary-subtle{% endif %}"
            href="{{ url_for('memories_list') }}"
          >
            <i class="bi bi-people-fill me-3 fs-5"></i>
            <span class="fs-6">Recuerdos</span>
          </a>

          <a
            class="nav-link d-flex align-items-center py-3 px-4 {% if request.endpoint == 'reminders' %}active bg-primary-subtle{% endif %}"
            href="{{ url_for('reminders') }}"
          >
            <i class="bi bi-alarm-fill me-3 fs-5"></i>
            <span class="fs-6">Recordatorios</span>
          </a>

          <a
            class="nav-link d-flex align-items-center py-3 px-4 {% if request.endpoint == 'alerts' %}active bg-primary-subtle{% endif %}"
            href="{{ url_for('alerts') }}"
          >
            <i class="bi bi-exclamation-triangle-fill me-3 fs-5"></i>
            <span class="fs-6">Alertas</span>
          </a>

          <a
            class="nav-link d-flex align-items-center py-3 px-4 {% if request.endpoint == 'family_create' %}active bg-primary-subtle{% endif %}"
            href="{{ url_for('family_create') }}"
          >
            <i class="bi bi-house-heart-fill me-3 fs-5"></i>
            <span class="fs-6">Familia & Invitaciones</span>
          </a>

          <a
            class="nav-link d-flex align-items-center py-3 px-4 {% if request.endpoint == 'info_alzheimer' %}active bg-primary-subtle{% endif %}"
            href="{{ url_for('info_alzheimer') }}"
          >
            <i class="bi bi-info-circle-fill me-3 fs-5"></i>
            <span class="fs-6">Información Alzheimer</span>
          </a>

          <hr class="mx-3 my-2" />

          <a
            class="nav-link d-flex align-items-center py-3 px-4"
            href="#configuracion"
          >
            <i class="bi bi-gear-fill me-3 fs-5"></i>
            <span class="fs-6">Configuración</span>
          </a>

          <a
            class="nav-link d-flex align-items-center py-3 px-4 text-danger"
            href="#cerrar-sesion"
          >
            <i class="bi bi-box-arrow-right me-3 fs-5"></i>
            <span class="fs-6">Cerrar Sesión</span>
          </a>
        </nav>
      </div>
    </div>

    <!-- Toast Container -->
    <div
      class="toast-container position-fixed top-0 end-0 p-3"
      style="z-index: 1100"
    >
      <div
        id="mainToast"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="toast-header">
          <i class="bi bi-info-circle-fill text-primary me-2"></i>
          <strong class="me-auto">RecuerdaMe</strong>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="toast"
            aria-label="Cerrar"
          ></button>
        </div>
        <div class="toast-body">
          <!-- Mensaje dinámico -->
        </div>
      </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ui.js') }}"></script>

    {% block scripts %}{% endblock %}
  </body>
</html>
